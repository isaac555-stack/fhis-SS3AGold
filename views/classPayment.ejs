<%- include("partials/sidebar.ejs") %>
<main>
  <h1>View Class Payments</h1>
  <section>
    <form action="/classes/:id" method="GET" aria-label="Select Class for Payment View">
      <label for="class-payment-class">Select Class:</label>
      <select id="class-payment-class" name="classId" required>
        <option value="" disabled selected>Select Class</option>
        <% classes.forEach(function(classItem) { %>
        <option value="<%= classItem.id %>"><%= classItem.name %></option>
        <% }) %>
      </select>
      <br /><br />
      <button type="submit" class="btn btn-primary">Submit</button>
    </form>
  </section>
  <% if (locals.students && students.length > 0) { %>
  <section aria-label="Class Payment Table">
    <table>
      <thead>
        <tr>
         
          <th>Name</th>
          <th>Class</th>
          <th>Total Fees</th>
          <th>Amount Paid</th>
          <th>Balance</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <% students.forEach(student => { %>
        <tr>
          
          <td><%= student.name %></td>
          <td><%= student.class_name %></td>
          <td>₦<%= Number(student.total_fees).toLocaleString() %></td>
          <td>₦<%= Number(student.amount_paid).toLocaleString() %></td>
          <td>
            ₦<%= Number(student.total_fees-student.amount_paid).toLocaleString() %>
          </td>
          <%if (student.total_fees===student.amount_paid){%>
          <td>
            FULL PAYMENT
          </td>
          <% }else if(student.total_fees>student.amount_paid && student.amount_paid>0){%>
            <td>
              PART PAYMENT
            </td>
            <% }else {%>
              <td>
                NO PAYMENT
              </td>
              <% } %>
        </tr>
        <% }) %>
      </tbody>
    </table>
  </section>
  <% } else if (locals.students) { %>
    <div role="alert" aria-live="polite" style="margin: 1rem 0; background: #fff; color: #111; padding: 12px; border-left: 4px solid #bd0918; border-radius: 4px;">
      No students have been added to this class yet.
    </div>
  <% } %>
</main>
<%- include("partials/footer.ejs") %>
